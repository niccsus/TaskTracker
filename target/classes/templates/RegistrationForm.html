<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>New User Registration</title>

    <link rel="stylesheet" th:href="@{/registration/registration-form.css}">
    <link rel="stylesheet" th:href="@{/registration/chosen-registration.css}">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script th:src="@{/js/chosen.jquery.js}" type="text/javascript"></script>
    <script th:src="@{/js/registration-form.js}"></script>
</head>

<body class="registration-body">
<!--
<svg
        xmlns="http://www.w3.org/2000/svg"
        height="24"
        viewBox="0 -960 960 960"
        width="24"
        id="menu"
>
    <path d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z"/>
</svg>
<div id ="overlay">

</div>

<div id ="sidebar">
    <a href = "/drill-schedule-recipient/" class = "sidebar-item">
        <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z"/></svg>
        <div>My Events</div>
    </a>
    <a href = "/drill-schedule-manager" class = "sidebar-item">
        <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-80h80v80h320v-80h80v80h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Zm280 240q-17 0-28.5-11.5T440-440q0-17 11.5-28.5T480-480q17 0 28.5 11.5T520-440q0 17-11.5 28.5T480-400Zm-160 0q-17 0-28.5-11.5T280-440q0-17 11.5-28.5T320-480q17 0 28.5 11.5T360-440q0 17-11.5 28.5T320-400Zm320 0q-17 0-28.5-11.5T600-440q0-17 11.5-28.5T640-480q17 0 28.5 11.5T680-440q0 17-11.5 28.5T640-400ZM480-240q-17 0-28.5-11.5T440-280q0-17 11.5-28.5T480-320q17 0 28.5 11.5T520-280q0 17-11.5 28.5T480-240Zm-160 0q-17 0-28.5-11.5T280-280q0-17 11.5-28.5T320-320q17 0 28.5 11.5T360-280q0 17-11.5 28.5T320-240Zm320 0q-17 0-28.5-11.5T600-280q0-17 11.5-28.5T640-320q17 0 28.5 11.5T680-280q0 17-11.5 28.5T640-240Z"/></svg>
        <div>Manage Events</div>
    </a>
    <a href = "/user-manager" class = "sidebar-item">
        <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Zm720 0v-120q0-44-24.5-84.5T666-434q51 6 96 20.5t84 35.5q36 20 55 44.5t19 53.5v120H760ZM360-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47Zm400-160q0 66-47 113t-113 47q-11 0-28-2.5t-28-5.5q27-32 41.5-71t14.5-81q0-42-14.5-81T544-792q14-5 28-6.5t28-1.5q66 0 113 47t47 113ZM120-240h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0 320Zm0-400Z"/></svg>
        <div>Manage Users</div>
    </a>
    <a href = "/logout" id = "logout" class = "sidebar-item">
        <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h280v80H200Zm440-160-55-58 102-102H360v-80h327L585-622l55-58 200 200-200 200Z"/></svg>
        <div>Logout</div>
    </a>

</div>
-->
<div class="registration-div">

    <h1 class="registration-header">New User Registration</h1>
    <p> Username is autogenerated by First and Last name (First.Last) </p>

    <form class="registration-form" th:action="@{/register-new-user}" th:object="${userAddRequest}"  method="post" autocomplete="off">

        <!--   username is now auto generated so this section isn't necessary anymore
        <div class="registration-input">
            <label class="registration-field-label registration-field-required" for="username">Username</label>
            <input class="registration-test-input" type="text" id="username" th:name="username" required>
        </div>
        -->
        <div th:if="${param.userAlreadyExists}">
            *User Already Exists</div>

        <div class="registration-input">
            <label class="registration-field-label registration-field-required" for="firstName">First Name</label>
            <input class="registration-text-input" type="text" id="firstName" th:name="firstName" required>
        </div>

        <div class="registration-input">
            <label class="registration-field-label registration-field-required" for="lastName">Last Name</label>
            <input class="registration-text-input" type="text" id="lastName" th:name="lastName" required>
        </div>

        <div class="registration-input">
            <label class="registration-field-label registration-field-required" for="password">Password</label>
            <input class="registration-text-input" type="password" id="password" th:name="password" required>
        </div>

        <div class="registration-input">
            <label class="registration-field-label registration-field-required" for="password">Confirm New Password</label>
            <input class="registration-text-input" type="password" id="passwordConfirm" th:name="passwordConfirm" required>
        </div>


        <div class="registration-input">
            <label class="registration-field-label registration-field-required" for="militaryEmail">Mil Email</label>
            <input class="registration-text-input" type="email" id="militaryEmail" th:name="militaryEmail" required>
        </div>

        <div class="registration-input">
            <label class="registration-field-label registration-field-required" for="civilianEmail">Civ Email</label>
            <input class="registration-text-input" type="email" id="civilianEmail" th:name="civilianEmail" required>
        </div>

        <div class="registration-input">
            <label class="registration-field-label" for="phoneNumber">Personal Phone</label>
            <input class="registration-text-input" type="tel" pattern="[0-9]{3}[0-9]{3}[0-9]{4}" id="phoneNumber"
                   th:name="phoneNumber">
        </div>

        <div class="registration-input">
            <label class="registration-field-label" for="officeNumber">Office Number</label>
            <input class="registration-text-input" type="tel" pattern="[0-9]{3}[0-9]{3}[0-9]{4}" id="officeNumber"
                   th:name="officeNumber">
        </div>

        <div class="registration-input">
            <label class="registration-field-label registration-field-required" for="rank">Rank</label>
            <select id="rank" th:name="rank">
                <option></option>
                <option th:each="rank : ${ranks}" th:value="${rank}" th:text="${rank}" required></option>
            </select>
        </div>

        <div class="registration-input">
            <label class="registration-field-label registration-field-required" for="flight">Flight</label>
            <select id="flight" th:name="flight">
                <option></option>
                <option th:each="flight : ${flights}" th:value="${flight}" th:text="${flight}" required></option>
            </select>
        </div>

        <div class="registration-input">
            <label class="registration-field-label registration-field-required" for="workcenter">Workcenter</label>
            <select id="workcenter" th:name="workCenter">
                <option></option>
                <option th:each="workcenter : ${workcenters}" th:value="${workcenter}" th:text="${workcenter}" required></option>
            </select>
        </div>

        <div class="registration-input">
            <label class="registration-field-label registration-field-required" for="teams">Teams</label>
            <select id="teams" th:name="teams" multiple>
                <option></option>
                <option th:each="team : ${teamList}" th:value="${team}" th:text="${team}" required></option>
            </select>
        </div>

        <input id="userRegisterButton" type="submit" value="Register" class="registration-submit" onclick="return verifyAllFields();">

    </form>

</div>

<img th:src="@{/registration/222-ISS-logo.png}" alt="Logo" width="150" height="150">

<script type="text/javascript">
    $(document).ready(function () {

        console.log("Select init");

        let select_field_css = {
            "width": "100%",
            "font-size": "1.5vh",
            "border-radius": "2px",
            "vertical-align": "center"
        };

        $('#rank').attr("data-placeholder", "Choose rank").chosen();
        $('#rank_chosen').css(select_field_css);

        $('#flight').attr("data-placeholder", "Choose flight").chosen();
        $('#flight_chosen').css(select_field_css);

        $('#workcenter').attr("data-placeholder", "Choose workcenter").chosen();
        $('#workcenter_chosen').css(select_field_css);

        $('#teams').attr("data-placeholder", "Choose teams").chosen();
        $('#teams_chosen').css(select_field_css);
    });

    function verifyAllFields() {
        try {
        var password = document.getElementById("password").value;
        var passwordConfirm = document.getElementById("passwordConfirm").value;
            if ($("#rank").val().length === 0) {
                alert("Please select a rank!");
                return false;
            } else if ($("#flight").val().length === 0) {
                alert("Please select a flight!");
                return false;
            } else if ($("#workcenter").val().length === 0) {
                alert("Please select a workcenter!");
                return false;
            } else if ($("#teams").val().length === 0) {
                alert("Please select at least one team!");
                return false;
            }  else if (password != passwordConfirm) {
                alert("Passwords do not match");
                return false;
            } else {
                return true;
            }
        } catch (e) {
            console.log(e);
            return false;
        }
    }
</script>
</body>
</html>